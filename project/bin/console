#!/usr/bin/env php
<?php

declare(strict_types=1);

require __DIR__ . '/../vendor/autoload.php';

use App\AppKernel;
use Symfony\Component\Console\Application;
use Symfony\Component\Console\Output\ConsoleOutput;

if (getenv('TZ') === false) {
    error_log('TZ is not set');
    exit(1);
}

AppKernel::initGlobalState((string) getenv('TZ'), true);

$consoleApplication = new Application();

try {
    $consoleApplication->run();
} catch (Exception $e) {
    $output = new ConsoleOutput();
    $output->writeln(sprintf('<error>%s</error>', $e->getMessage()));
    exit();
}
